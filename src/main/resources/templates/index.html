<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{header :: setFragment(~{this::content})}">
    <th:block th:fragment="content">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영화 목록</title>
    <style>
        .container {
            display: flex;
            flex-wrap: wrap;
            width: 1400px;
            margin: 0 auto;
        }
        .nowPlayingMovie {
            box-sizing: border-box;
            padding: 10px;
            width: 320px;
            height: 350px;
            display: table-cell;
        }
        .nowPlayingMovie ul {
            list-style-type: none;
            padding: 0;
            width: 200px;
            text-align: center;
        }
        .nowPlayingMovie li {
            font-size: 14px;
            margin-bottom: -29px;
            text-align: left;
        }
        .nowPlayingMovie img {
            width: 240px;
            height: 340px;
            display: block;
            margin-bottom: 10px;
            float: left;
            margin-right: 20px;
            border-radius: 10px;
            box-shadow: 1px 2px 6px gray;
        }
        .movie iframe {
            width: 100%;
            height: 200px;
        }
        .commentOutBox, .nowPlayingOutBox{
            width: 1400px;
            height: 50px;
            /*background-color: antiquewhite;*/
            line-height: 50px;
            font-size: 1.2em;
            margin: 10px 0 250px;
            padding-left: 10px;
        }
        .nowPlayingOutBox{
            position: relative;
            height: 520px;
            padding: 0 30px;
            overflow: hidden;
        }

        .commentOutBox p{
            width: 1400px;
            padding-left: 40px;
        }
        .nowPlayingOutBox p{
            width: 1400px;
            padding-left: 40px;
        }
        .commentInBox{
            width: 1400px;
            height: 180px;
            display: flex;
            justify-content: space-around;
            padding: 10px;
        }
        .comment{
            width: 420px;
            height: 100%;
            border-radius: 20px;
            border: 1px solid gainsboro;
        }
        .button-right{
            width: 50px;
            height: 50px;
            outline: none;
            border: 1px solid gray;
            border-radius: 50px;
            z-index: 10;
            background-color: white;
            position: absolute;
            top: 600px;
            right: 100px;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div class="container">
<!--    <a th:href="@{/movie/detail}">디테일페이지 가기</a>-->
    <div class="commentOutBox">
        <p class="commentTitle">지금 뜨는 코멘트</p>
        <div class="commentInBox">
            <div class="comment">

            </div>
            <div class="comment">

            </div>
            <div class="comment">

            </div>
        </div>
    </div>
    <div class="nowPlayingOutBox" id="movieContainer">
        <p class="nowPlayingTitle">현재 상영작</p>

    </div>
    <button type="button" class="button-right"> > </button>
</div>
<script>
    const options = {
        method: 'GET',
        headers: {
            accept: 'application/json',
            Authorization: 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJhZmRmZTQ3YTQ0NzU2ZTI5MDAyNTcxNWE2YjQyZDhkNSIsIm5iZiI6MTcyMDU1MTg4Mi44MzAxMDcsInN1YiI6IjY2MDNkNTE3NjA2MjBhMDE3YzMwMjY0OCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.kW6FWbNBxEum0GSPLqFOf-LQu3BMA-50-IJXe_Hd3w8'
        }
    };

    const fetchMovieData = async () => {
        try {
            const response = await fetch('https://api.themoviedb.org/3/movie/now_playing?language=ko-KR&page=1&region=KR', options);
            const data = await response.json();
            return data.results;
        } catch (error) {
            console.error('Error fetching movie data:', error);
        }
    };
    const displayMovies = async () => {
        const movies = await fetchMovieData();
        const movieContainer = document.getElementById('movieContainer');
        const imageBaseUrl = 'https://image.tmdb.org/t/p/w500';

        for (const movie of movies) {
            console.log(movie)
            const movieDiv = document.createElement('div');
            movieDiv.classList.add('nowPlayingMovie');

            const posterPath = movie.poster_path ? `${imageBaseUrl}${movie.poster_path}` : '';
            const backdropPath = movie.backdrop_path ? `${imageBaseUrl}${movie.backdrop_path}` : '';

            const movieDetails = `
                    <div class="nowPlayingMovie">
                    <img src="${posterPath}" alt="${movie.title} 포스터">
                    <ul>
                        <li>${movie.title}</li>
                        <li>${movie.release_date}</li>
                        <li>${movie.vote_average}</li>
                    </ul>
                    </div>
                `;
            movieDiv.innerHTML = movieDetails;
            movieContainer.appendChild(movieDiv);
        }
    };

    displayMovies();

    const buttonRight = document.querySelector('.button-right');
    buttonRight.addEventListener('click', () => {
        console.log("버튼 클릭");
    });

</script>
            </body>
        </th:block>
    </th:block>
</html>
